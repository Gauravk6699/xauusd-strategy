import csv
import io

csv_data = """entry_time,entry_price,exit_time,exit_price,size,gross_pnl,swap_charges,spread_cost,mae,pnl,status
2024-06-04 01:30:00,30.57854,2024-06-04 02:00:00,30.73143,1,764.46347,-0.00000,0.00000,-231.69500,764.46347,CLOSED_TP
2024-06-04 03:30:00,30.57854,2024-06-04 06:00:00,30.73143,1,764.46347,-0.00000,0.00000,-311.69500,764.46347,CLOSED_TP
2024-06-04 06:00:00,30.57854,2024-06-04 06:00:00,30.73143,1,764.46347,0.00000,0.00000,-210.19500,764.46347,CLOSED_TP_SAME_CANDLE
2024-06-04 07:45:00,30.27122,2024-06-04 07:45:00,30.42257,1,756.78042,0.00000,0.00000,-83.58500,756.78042,CLOSED_TP_SAME_CANDLE
2024-06-04 09:00:00,29.81023,2024-06-04 09:00:00,29.95929,1,745.25585,0.00000,0.00000,-1025.17000,745.25585,CLOSED_TP_SAME_CANDLE
2024-06-04 10:45:00,29.65657,2024-06-04 12:15:00,29.80486,1,741.41432,-0.00000,0.00000,-294.86500,741.41432,CLOSED_TP
2024-06-04 09:15:00,29.81023,2024-06-04 12:30:00,29.95929,1,745.25585,-0.00000,0.00000,-1063.17000,745.25585,CLOSED_TP
2024-06-04 13:00:00,29.81023,2024-06-04 13:00:00,29.95929,1,745.25585,0.00000,0.00000,-325.17000,745.25585,CLOSED_TP_SAME_CANDLE
2024-06-04 14:00:00,29.50291,2024-06-04 14:00:00,29.65043,1,737.57280,0.00000,0.00000,-320.06000,737.57280,CLOSED_TP_SAME_CANDLE
2024-06-04 14:15:00,29.50291,2024-06-05 02:45:00,29.65043,1,737.57280,-22.00000,0.00000,-587.56000,715.57280,CLOSED_TP
2024-06-05 07:15:00,29.42882,2024-06-05 08:00:00,29.57596,1,735.72041,-0.00000,0.00000,-123.08250,735.72041,CLOSED_TP
2024-06-04 13:45:00,29.65657,2024-06-05 15:00:00,29.80486,1,741.41432,-22.00000,0.00000,-1355.86500,719.41432,CLOSED_TP
2024-06-04 13:30:00,29.81023,2024-06-05 16:15:00,29.95929,1,745.25585,-22.00000,0.00000,-2124.17000,723.25585,CLOSED_TP
2024-06-04 08:15:00,30.11756,2024-06-06 01:00:00,30.26814,1,752.93890,-44.00000,0.00000,-3660.78000,708.93890,CLOSED_TP
2024-06-04 08:30:00,29.96389,2024-06-06 01:00:00,30.11371,1,749.09737,-44.00000,0.00000,-2892.47500,705.09737,CLOSED_TP
2024-06-04 08:00:00,30.27122,2024-06-06 01:15:00,30.42257,1,756.78042,-44.00000,0.00000,-4429.08500,712.78042,CLOSED_TP
2024-06-04 07:30:00,30.42488,2024-06-06 02:45:00,30.57700,1,760.62195,-44.00000,0.00000,-5197.39000,716.62195,CLOSED_TP
2024-06-04 07:00:00,30.57854,2024-06-06 15:00:00,30.73143,1,764.46347,-44.00000,0.00000,-5965.69500,720.46347,CLOSED_TP
2024-06-07 01:30:00,31.16758,2024-06-07 03:45:00,31.32342,1,779.18947,-0.00000,0.00000,-464.39500,779.18947,CLOSED_TP
2024-06-07 08:00:00,31.01096,2024-06-07 08:00:00,31.16601,1,775.27395,0.00000,0.00000,-563.79000,775.27395,CLOSED_TP_SAME_CANDLE
2024-06-07 11:00:00,30.22785,2024-06-07 11:00:00,30.37899,1,755.69632,0.00000,0.00000,-78.26500,755.69632,CLOSED_TP_SAME_CANDLE
2024-06-07 13:30:00,29.75799,2024-06-07 13:30:00,29.90678,1,743.94975,0.00000,0.00000,-643.95000,743.94975,CLOSED_TP_SAME_CANDLE
2024-06-07 14:00:00,29.60137,2024-06-07 14:30:00,29.74938,1,740.03422,-0.00000,0.00000,-1014.84500,740.03422,CLOSED_TP
2024-06-07 14:45:00,29.60137,2024-06-07 14:45:00,29.74938,1,740.03422,0.00000,0.00000,-330.84500,740.03422,CLOSED_TP_SAME_CANDLE
2024-06-07 15:15:00,29.44475,2024-06-07 15:15:00,29.59197,1,736.11870,0.00000,0.00000,-486.24000,736.11870,CLOSED_TP_SAME_CANDLE
2024-06-07 15:45:00,29.28813,2024-06-07 16:45:00,29.43457,1,732.20317,-0.00000,0.00000,-119.13500,732.20317,CLOSED_TP
2024-06-07 20:45:00,29.13151,2024-06-09 22:45:00,29.27716,1,728.28765,-44.00000,0.00000,-366.53000,684.28765,CLOSED_TP
2024-06-07 17:45:00,29.28813,2024-06-10 01:30:00,29.43457,1,732.20317,-66.00000,0.00000,-1149.63500,666.20317,CLOSED_TP
2024-06-07 15:30:00,29.44475,2024-06-10 05:45:00,29.59197,1,736.11870,-66.00000,0.00000,-1932.74000,670.11870,CLOSED_TP
2024-06-07 15:00:00,29.60137,2024-06-10 11:15:00,29.74938,1,740.03422,-66.00000,0.00000,-2715.84500,674.03422,CLOSED_TP
2024-06-11 01:30:00,29.41805,2024-06-11 01:30:00,29.56514,1,735.45120,0.00000,0.00000,-114.24000,735.45120,CLOSED_TP_SAME_CANDLE
2024-06-11 02:15:00,29.12090,2024-06-11 08:00:00,29.26650,1,728.02240,-0.00000,0.00000,-351.48000,728.02240,CLOSED_TP
2024-06-11 02:00:00,29.26947,2024-06-11 12:15:00,29.41582,1,731.73680,-0.00000,0.00000,-1094.36000,731.73680,CLOSED_TP
2024-06-11 13:45:00,29.12090,2024-06-11 14:30:00,29.26650,1,728.02240,-0.00000,0.00000,-23.48000,728.02240,CLOSED_TP
2024-06-11 15:15:00,29.12090,2024-06-11 20:45:00,29.26650,1,728.02240,-0.00000,0.00000,-208.48000,728.02240,CLOSED_TP
2024-06-11 13:15:00,29.26947,2024-06-12 01:45:00,29.41582,1,731.73680,-22.00000,0.00000,-951.36000,709.73680,CLOSED_TP
2024-06-07 13:45:00,29.75799,2024-06-12 12:30:00,29.90678,1,743.94975,-110.00000,0.00000,-3536.95000,633.94975,CLOSED_TP
2024-06-11 01:00:00,29.56662,2024-06-12 12:30:00,29.71446,1,739.16560,-22.00000,0.00000,-2580.12000,717.16560,CLOSED_TP
2024-06-11 01:45:00,29.41805,2024-06-12 12:30:00,29.56514,1,735.45120,-22.00000,0.00000,-1837.24000,713.45120,CLOSED_TP
2024-06-07 12:45:00,30.07123,2024-06-12 13:00:00,30.22159,1,751.78080,-110.00000,0.00000,-5103.16000,641.78080,CLOSED_TP
2024-06-07 13:00:00,29.91461,2024-06-12 13:00:00,30.06418,1,747.86527,-110.00000,0.00000,-4320.05500,637.86527,CLOSED_TP
2024-06-13 01:00:00,29.38852,2024-06-13 01:00:00,29.53546,1,734.71297,0.00000,0.00000,-1851.59500,734.71297,CLOSED_TP_SAME_CANDLE
2024-06-13 01:45:00,29.09316,2024-06-13 06:00:00,29.23862,1,727.32892,-0.00000,0.00000,-579.78500,727.32892,CLOSED_TP
2024-06-13 01:30:00,29.24084,2024-06-13 09:15:00,29.38704,1,731.02095,-0.00000,0.00000,-1948.19000,731.02095,CLOSED_TP
2024-06-13 11:00:00,29.24084,2024-06-13 12:30:00,29.38704,1,731.02095,-0.00000,0.00000,-1073.19000,731.02095,CLOSED_TP
2024-06-13 11:30:00,29.09316,2024-06-13 12:30:00,29.23862,1,727.32892,-0.00000,0.00000,-334.78500,727.32892,CLOSED_TP
2024-06-13 12:30:00,29.24084,2024-06-13 12:30:00,29.38704,1,731.02095,0.00000,0.00000,-713.19000,731.02095,CLOSED_TP_SAME_CANDLE
2024-06-13 14:00:00,29.09316,2024-06-13 14:00:00,29.23862,1,727.32892,0.00000,0.00000,-39.78500,727.32892,CLOSED_TP_SAME_CANDLE
2024-06-13 15:45:00,28.79780,2024-06-13 17:00:00,28.94178,1,719.94487,-0.00000,0.00000,-657.97500,719.94487,CLOSED_TP
2024-06-13 15:15:00,28.94548,2024-06-14 02:45:00,29.09020,1,723.63690,-22.00000,0.00000,-1396.38000,701.63690,CLOSED_TP
2024-06-13 14:15:00,29.09316,2024-06-14 10:45:00,29.23862,1,727.32892,-22.00000,0.00000,-2134.78500,705.32892,CLOSED_TP
2024-06-13 13:45:00,29.24084,2024-06-14 16:00:00,29.38704,1,731.02095,-22.00000,0.00000,-2873.19000,709.02095,CLOSED_TP
2024-06-13 01:15:00,29.38852,2024-06-14 19:30:00,29.53546,1,734.71297,-22.00000,0.00000,-3611.59500,712.71297,CLOSED_TP
2024-06-17 01:00:00,29.34175,2024-06-17 01:00:00,29.48846,1,733.54385,0.00000,0.00000,-77.77000,733.54385,CLOSED_TP_SAME_CANDLE
2024-06-17 06:00:00,29.04686,2024-06-17 08:45:00,29.19210,1,726.17155,-0.00000,0.00000,-108.31000,726.17155,CLOSED_TP
2024-06-17 03:30:00,29.19431,2024-06-17 13:00:00,29.34028,1,729.85770,-0.00000,0.00000,-845.54000,729.85770,CLOSED_TP
2024-06-17 02:00:00,29.34175,2024-06-17 13:15:00,29.48846,1,733.54385,-0.00000,0.00000,-1582.77000,733.54385,CLOSED_TP
2024-06-17 15:30:00,29.19431,2024-06-17 15:30:00,29.34028,1,729.85770,0.00000,0.00000,-500.54000,729.85770,CLOSED_TP_SAME_CANDLE
2024-06-17 15:45:00,29.19431,2024-06-17 17:00:00,29.34028,1,729.85770,-0.00000,0.00000,-365.54000,729.85770,CLOSED_TP
2024-06-17 13:30:00,29.34175,2024-06-17 19:30:00,29.48846,1,733.54385,-0.00000,0.00000,-1237.77000,733.54385,CLOSED_TP
2024-06-18 10:45:00,29.06459,2024-06-18 12:00:00,29.20991,1,726.61480,-0.00000,0.00000,-31.96000,726.61480,CLOSED_TP
2024-06-18 12:45:00,29.06459,2024-06-18 12:45:00,29.20991,1,726.61480,0.00000,0.00000,-696.96000,726.61480,CLOSED_TP_SAME_CANDLE
2024-06-18 13:00:00,29.06459,2024-06-18 13:00:00,29.20991,1,726.61480,0.00000,0.00000,-621.96000,726.61480,CLOSED_TP_SAME_CANDLE
2024-06-18 08:00:00,29.21213,2024-06-18 13:30:00,29.35819,1,730.30320,-0.00000,0.00000,-1434.64000,730.30320,CLOSED_TP
2024-06-18 13:30:00,29.21213,2024-06-18 13:30:00,29.35819,1,730.30320,0.00000,0.00000,-109.64000,730.30320,CLOSED_TP_SAME_CANDLE
2024-06-18 15:00:00,29.21213,2024-06-18 15:15:00,29.35819,1,730.30320,-0.00000,0.00000,-64.64000,730.30320,CLOSED_TP
2024-06-18 06:00:00,29.35966,2024-06-18 17:15:00,29.50646,1,733.99160,-0.00000,0.00000,-2172.32000,733.99160,CLOSED_TP
2024-06-19 01:00:00,29.37956,2024-06-19 01:45:00,29.52646,1,734.48910,-0.00000,0.00000,-96.82000,734.48910,CLOSED_TP
2024-06-19 05:30:00,29.37956,2024-06-19 07:30:00,29.52646,1,734.48910,-0.00000,0.00000,-156.82000,734.48910,CLOSED_TP
2024-06-07 12:30:00,30.22785,2024-06-20 05:00:00,30.37899,1,755.69632,-286.00000,0.00000,-7808.26500,469.69632,CLOSED_TP
2024-06-07 10:30:00,30.38447,2024-06-20 14:15:00,30.53640,1,759.61185,-286.00000,0.00000,-8591.37000,473.61185,CLOSED_TP
2024-06-07 09:15:00,30.54110,2024-06-20 14:45:00,30.69380,1,763.52737,-286.00000,0.00000,-9374.47500,477.52737,CLOSED_TP
2024-06-21 07:15:00,30.30490,2024-06-21 08:15:00,30.45643,1,757.62260,-0.00000,0.00000,-358.52000,757.62260,CLOSED_TP
2024-06-21 13:00:00,30.15107,2024-06-21 13:00:00,30.30183,1,753.77680,0.00000,0.00000,-84.36000,753.77680,CLOSED_TP_SAME_CANDLE
2024-06-21 13:30:00,29.99724,2024-06-21 13:30:00,30.14723,1,749.93100,0.00000,0.00000,-295.20000,749.93100,CLOSED_TP_SAME_CANDLE
2024-06-23 23:45:00,29.39548,2024-06-24 01:00:00,29.54246,1,734.88710,-22.00000,0.00000,-261.42000,712.88710,CLOSED_TP
2024-06-21 18:00:00,29.53574,2024-06-24 07:45:00,29.68342,1,738.39360,-66.00000,0.00000,-962.72000,672.39360,CLOSED_TP
2024-06-25 01:45:00,29.38454,2024-06-25 04:15:00,29.53146,1,734.61347,-0.00000,0.00000,-601.69500,734.61347,CLOSED_TP
2024-06-25 13:30:00,29.23688,2024-06-25 13:30:00,29.38306,1,730.92195,0.00000,0.00000,-488.39000,730.92195,CLOSED_TP_SAME_CANDLE
2024-06-26 01:45:00,28.72087,2024-06-26 02:15:00,28.86448,1,718.02185,-0.00000,0.00000,-18.37000,718.02185,CLOSED_TP
2024-06-26 13:15:00,28.72087,2024-06-26 13:15:00,28.86448,1,718.02185,0.00000,0.00000,-398.37000,718.02185,CLOSED_TP_SAME_CANDLE
2024-06-26 13:30:00,28.72087,2024-06-26 15:00:00,28.86448,1,718.02185,-0.00000,0.00000,-693.37000,718.02185,CLOSED_TP
2024-06-26 22:45:00,28.72087,2024-06-27 09:00:00,28.86448,1,718.02185,-22.00000,0.00000,-208.37000,696.02185,CLOSED_TP
2024-06-25 15:30:00,28.94156,2024-06-27 12:30:00,29.08626,1,723.53890,-44.00000,0.00000,-1796.78000,679.53890,CLOSED_TP
2024-06-25 15:15:00,29.08922,2024-06-27 13:00:00,29.23466,1,727.23042,-44.00000,0.00000,-2535.08500,683.23042,CLOSED_TP
2024-06-28 01:00:00,28.85520,2024-06-28 02:30:00,28.99947,1,721.37997,-0.00000,0.00000,-384.99500,721.37997,CLOSED_TP
2024-06-25 13:45:00,29.23688,2024-06-28 12:15:00,29.38306,1,730.92195,-66.00000,0.00000,-3273.39000,664.92195,CLOSED_TP
2024-06-25 13:15:00,29.38454,2024-06-28 13:00:00,29.53146,1,734.61347,-66.00000,0.00000,-4011.69500,668.61347,CLOSED_TP
2024-07-02 03:45:00,29.31290,2024-07-02 12:30:00,29.45946,1,732.82247,-0.00000,0.00000,-528.49500,732.82247,CLOSED_TP
2024-06-21 15:15:00,29.68958,2024-07-03 06:45:00,29.83802,1,742.23940,-264.00000,0.00000,-5536.88000,478.23940,CLOSED_TP
2024-06-21 14:00:00,29.84341,2024-07-03 07:15:00,29.99263,1,746.08520,-264.00000,0.00000,-6306.04000,482.08520,CLOSED_TP
2024-06-21 13:45:00,29.99724,2024-07-03 07:45:00,30.14723,1,749.93100,-264.00000,0.00000,-7075.20000,485.93100,CLOSED_TP
2024-06-21 13:15:00,30.15107,2024-07-03 12:00:00,30.30183,1,753.77680,-264.00000,0.00000,-7844.36000,489.77680,CLOSED_TP
2024-06-21 12:30:00,30.30490,2024-07-03 12:30:00,30.45643,1,757.62260,-264.00000,0.00000,-8613.52000,493.62260,CLOSED_TP
2024-06-21 06:15:00,30.45874,2024-07-03 14:15:00,30.61103,1,761.46840,-264.00000,0.00000,-9382.68000,497.46840,CLOSED_TP
2024-07-04 06:30:00,30.21797,2024-07-04 07:30:00,30.36906,1,755.44920,-0.00000,0.00000,-84.34000,755.44920,CLOSED_TP
2024-07-04 03:45:00,30.37058,2024-07-05 01:00:00,30.52244,1,759.26460,-22.00000,0.00000,-847.42000,737.26460,CLOSED_TP
2024-06-21 01:15:00,30.61257,2025-07-05 12:45:00,30.76563,1,765.31420,-308.00000,0.00000,-10151.84000,457.31420,CLOSED_TP
2024-06-07 08:45:00,30.69772,2025-07-05 13:00:00,30.85120,1,767.44290,-616.00000,0.00000,-10577.58000,151.44290,CLOSED_TP
2024-06-07 08:30:00,30.85434,2025-07-05 14:30:00,31.00861,1,771.35842,-616.00000,0.00000,-11360.68500,155.35842,CLOSED_TP
2024-06-07 08:15:00,31.01096,2025-07-05 15:00:00,31.16601,1,775.27395,-616.00000,0.00000,-12143.79000,159.27395,CLOSED_TP
2024-06-07 06:00:00,31.16758,2025-07-05 15:45:00,31.32342,1,779.18947,-616.00000,0.00000,-12926.89500,163.18947,CLOSED_TP
2025-06-03 01:00:00,34.54839,STILL_OPEN,34.58620,1,189.05000,-0.00000,0.00000,-2870.95000,189.05000,STILL_OPEN
"""

# Use io.StringIO to treat the string as a file
csvfile = io.StringIO(csv_data)
reader = csv.reader(csvfile)

header = next(reader) # Skip header row
mae_column_index = header.index('mae')

min_mae = float('inf') # Initialize with a very large number

for row in reader:
    if row[mae_column_index]: # Ensure the MAE value is not empty
        try:
            mae_value = float(row[mae_column_index])
            if mae_value < min_mae:
                min_mae = mae_value
        except ValueError:
            print(f"Could not convert MAE value '{row[mae_column_index]}' to float for row: {row}")
            continue # Skip this row if MAE is not a valid float

if min_mae == float('inf'):
    print("No valid MAE values found in the trade log.")
else:
    print(f"The maximum floating loss (minimum MAE) was: {min_mae:.2f}")
